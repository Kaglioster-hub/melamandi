@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========== THEME TOKENS (light default) ========== */
@layer base {
  :root{
    /* LIGHT (default) */
    --bg:#f7faf8;
    --fg:#0b0f0e;
    --panel:rgba(0,0,0,.045);
    --border:rgba(0,0,0,.12);
    /* shared */
    --brand-glow: rgba(34,197,94,.45);
    color-scheme: light dark; /* abilita UAs a scegliere il set giusto */
  }

  /* Preferenza OS: quando NON c'è override manuale */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
      --bg:#0b0f0e;
      --fg:#eaf6ef;
      --panel:rgba(255,255,255,.045);
      --border:rgba(255,255,255,.12);
    }
  }

  /* Override manuali */
  :root[data-theme="light"]{
    --bg:#f7faf8;
    --fg:#0b0f0e;
    --panel:rgba(0,0,0,.045);
    --border:rgba(0,0,0,.12);
  }
  :root[data-theme="dark"]{
    --bg:#0b0f0e;
    --fg:#eaf6ef;
    --panel:rgba(255,255,255,.045);
    --border:rgba(255,255,255,.12);
  }

  ::selection{ background:rgba(34,197,94,.30); }
  html,body{ height:100% }
  html{ scroll-behavior:smooth; -webkit-text-size-adjust:100%; }
  body{
    @apply antialiased;
    color: var(--fg);
    background-color: var(--bg);
    background-image:
      radial-gradient(1200px 400px at 10% 0%, rgba(139,92,246,.10), transparent),
      radial-gradient(1200px 400px at 90% 0%, rgba(245,158,11,.10), transparent);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

/* ========== COMPONENTS (con fallback, no classi “pericolose” in @apply) ========== */
@layer components {
  .container{ @apply max-w-7xl mx-auto px-4; }

  .card{
    @apply rounded-2xl p-4 border;
    background-color: var(--panel);
    border-color: var(--border);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }
  .card:hover{ box-shadow: 0 10px 26px rgba(0,0,0,.15); }

  .pill{
    @apply px-3 py-1 rounded-full text-sm transition border;
    background-color: var(--panel);
    border-color: var(--border);
  }
  .pill:focus-visible{ @apply outline-none ring-2 ring-green-500; }

  .btn{
    @apply inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 transition border;
    min-height: 44px;
    border-color: var(--border);
    background-color: transparent;
    color: inherit;
  }
  .btn-primary{
    @apply bg-gradient-to-r from-green-500 to-amber-500 text-black font-medium;
  }
  .btn:focus-visible{ @apply outline-none ring-2 ring-green-500 ring-offset-2; }
  .btn[disabled]{ @apply opacity-50 pointer-events-none; }

  .header{
    @apply sticky top-0 z-50 border-b;
    border-color: var(--border);
    background-color: color-mix(in oklab, var(--bg) 72%, transparent);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  .header-inner{ @apply container h-14 flex items-center justify-between; }

  /* LOGO più visibile (badge) */
  .logo-badge{
    @apply inline-flex items-center justify-center rounded-xl;
    width: 2.25rem; height: 2.25rem;
    background: radial-gradient(60% 60% at 50% 40%, rgba(34,197,94,.22), transparent);
    border: 1px solid var(--border);
    box-shadow: 0 0 0 3px rgba(34,197,94,.08);
  }
  .logo{ width: 1.5rem; height: 1.5rem; filter: drop-shadow(0 2px 8px var(--brand-glow)); }
  .brand{ @apply font-semibold tracking-tight; font-size: clamp(1rem, 1.2vw + .9rem, 1.25rem); }

  a.nav{ @apply text-sm opacity-80 hover:opacity-100 px-3 py-1 rounded-md; min-height: 36px; }
  a.nav[aria-current="page"]{ @apply opacity-100; box-shadow: inset 0 -2px 0 0 rgba(34,197,94,.7); }

  /* Griglia catalogo fluida */
  .grid-catalog{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1rem;
  }

  .tap-target{ min-width:44px; min-height:44px; }
}

/* ========== UTILITIES ========== */
@layer utilities {
  .text-balance{ text-wrap: balance; }
  .min-w-0{ min-width:0; }
}

/* Motion safety */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration:.001ms !important; animation-iteration-count:1 !important; transition-duration:.001ms !important; scroll-behavior:auto !important; }
}

/* Responsive piccoli aggiustamenti */
@media (max-width: 640px){
  .header-inner{ height: 56px; }
}
